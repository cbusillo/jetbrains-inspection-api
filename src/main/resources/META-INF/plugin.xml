<idea-plugin>
    <id>com.shiny.inspection.api</id>
    <name>Inspection API</name>
    <version>1.11.4</version>
    <vendor email="info@shinycomputers.com" url="https://github.com/cbusillo/jetbrains-inspection-api">Shiny Computers (Chris Busillo)</vendor>
    <resource-bundle>messages.InspectionApiBundle</resource-bundle>
    
    <description><![CDATA[
        Exposes JetBrains IDE inspection results via HTTP API for automated tools and AI assistants.
        Includes a bundled MCP server so AI clients can use real IDE inspections instead of scraping logs
        or running duplicate linters. This is especially valuable for IDE-only checks (for example,
        PyCharm’s Odoo plugin inspections).
        <br/><br/>
        Features:
        <ul>
            <li>HTTP API access to inspection results</li>
            <li>Scope-based filtering (whole project, current file, directory)</li>
            <li>Trigger inspections programmatically and poll status</li>
            <li>Works with JetBrains IDEs (2025.x compatible)</li>
            <li>Bundled MCP server + setup command for Code, Codex CLI, Claude Code, and Gemini CLI</li>
            <li>IDE-only inspections (e.g., PyCharm’s Odoo plugin checks) are made available to automation</li>
        </ul>
        <br/>
        Endpoints available at http://localhost:&lt;Built-in Server Port&gt;/api/inspection/*
        <br/>
        Tip: Check your IDE's built-in server port under Settings → Tools → Web Browsers and Preview.
    ]]></description>
    
    <change-notes><![CDATA[
        <b>Version 1.11.0</b>
        <ul>
            <li>Bundled JVM MCP server (no Node.js dependency).</li>
            <li>New long-poll endpoint: <code>/api/inspection/wait</code> and MCP tool <code>inspection_wait</code>.</li>
            <li>New IDE action: <code>Tools → Copy MCP Setup</code> (client picker for Code, Codex, Claude, Gemini).</li>
        </ul>
        <b>Version 1.10.13</b>
        <ul>
            <li>Problems endpoint now treats <code>scope=files</code>, <code>directory</code>, and <code>changed_files</code> as trigger-only (no accidental filtering).</li>
        </ul>
        <b>Version 1.10.11</b>
        <ul>
            <li>Prefers Inspect Code results over Problems View when available (reduces noise from generated files).</li>
            <li>Improves file_pattern filtering (regex + simple globs like <code>*.py</code>).</li>
        </ul>
        <b>Version 1.10.10</b>
        <ul>
            <li>Status detection unified across Problems and Inspection Results windows</li>
            <li>Clears stale results from both windows before triggering</li>
            <li>MCP error messages improved when the IDE server is unreachable</li>
            <li>Changed files mode filtering (staged/unstaged) implemented (Git best‑effort)</li>
        </ul>
        <b>Earlier Versions</b>
        <ul>
            <li>New trigger scopes: <code>files</code> and <code>changed_files</code></li>
            <li>New trigger params: <code>file</code>/<code>files</code>, <code>include_unversioned</code>, <code>changed_files_mode</code>, <code>max_files</code>, <code>profile</code></li>
            <li>MCP tool updated with concise parameter docs</li>
            <li>Programmatic inspection triggering with status polling</li>
            <li>Scope filtering (whole project, current file, directory)</li>
            <li>Enhanced results extraction and severity mapping (incl. grammar/typo)</li>
            <li>MCP tools for AI assistants</li>
            <li>JetBrains 2025.x compatibility updates</li>
            <li>Initial HTTP API and status detection</li>
        </ul>
    ]]></change-notes>
    
    <depends>com.intellij.modules.platform</depends>
    
    <extensions defaultExtensionNs="com.intellij">
        <httpRequestHandler implementation="com.shiny.inspectionmcp.InspectionHandler"/>
        <notificationGroup
                id="inspection.api"
                displayType="BALLOON"
                bundle="messages.InspectionApiBundle"
                key="notification.group.name" />
        <postStartupActivity implementation="com.shiny.inspectionmcp.McpOnboardingStartupActivity"/>
    </extensions>

    <actions resource-bundle="messages.InspectionApiBundle">
        <action id="InspectionApi.CopyMcpCommand"
                class="com.shiny.inspectionmcp.CopyMcpCommandAction">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
